#include <windows.h>

char code[]={0x55
	,0x8B,0xEC
	,0x83,0xEC,0x1C
	,0xC6,0x45,0xE9,0x75
	,0xC6,0x45,0xEA,0x73
	,0xC6,0x45,0xEB,0x65
	,0xC6,0x45,0xEC,0x72
	,0xC6,0x45,0xED,0x33
	,0xC6,0x45,0xEE,0x32
	,0xC6,0x45,0xEF,0x2E
	,0xC6,0x45,0xF0,0x64
	,0xC6,0x45,0xF1,0x6C
	,0xC6,0x45,0xF2,0x6C
	,0xC6,0x45,0xF3,0x00
	,0x8D,0x45,0xE9
	,0x50
	,0xE8,0x41,0x0D,0x40,0x7C
	,0x83,0xC4,0x1C
	,0x5D
	,0x55
	,0x8B,0xEC
	,0x83,0xEC,0x1C
	,0xC6,0x45,0xE8,0x4D
	,0xC6,0x45,0xE9,0x65
	,0xC6,0x45,0xEA,0x73
	,0xC6,0x45,0xEB,0x73
	,0xC6,0x45,0xEC,0x61
	,0xC6,0x45,0xED,0x67
	,0xC6,0x45,0xEE,0x65
	,0xC6,0x45,0xEF,0x42
	,0xC6,0x45,0xF0,0x6F
	,0xC6,0x45,0xF1,0x78
	,0xC6,0x45,0xF2,0x41
	,0xC6,0x45,0xF3,0x00
	,0x8D,0x4D,0xE8
	,0x51
	,0x50
	,0xFF,0x15,0xBF,0x9E,0x40,0x7C
	,0x83,0xC4,0x1C
	,0x5D
	,0x55
	,0x8B,0xEC
	,0x83,0xEC,0x1C
	,0xC6,0x45,0xE8,0x49
	,0xC6,0x45,0xE9,0x27
	,0xC6,0x45,0xEA,0x6D
	,0xC6,0x45,0xEB,0x20
	,0xC6,0x45,0xEC,0x68
	,0xC6,0x45,0xED,0x61
	,0xC6,0x45,0xEE,0x63
	,0xC6,0x45,0xEF,0x6B
	,0xC6,0x45,0xF0,0x65
	,0xC6,0x45,0xF1,0x64
	,0xC6,0x45,0xF2,0x21
	,0xC6,0x45,0xF3,0x00
	,0x8D,0x4D,0xE8
	,0x6A,0x00
	,0x51
	,0x51
	,0x6A,0x00
	,0xFF,0xD0
	,0x83,0xC4,0x1C
	,0x5D
	,0xC3
};

__declspec(naked) void main()
{	
	__asm{
	   //hModUser32 = LoadLibraryA(“user32.dll”);
	   push ebp
	   mov ebp,esp
	   sub esp,28
	   mov  [ebp-0x17], 'u'
	   mov  [ebp-0x16], 's'
	   mov  [ebp-0x15], 'e'
	   mov  [ebp-0x14], 'r'
	   mov  [ebp-0x13], '3'
	   mov  [ebp-0x12], '2'
	   mov  [ebp-0x11], '.'
	   mov  [ebp-0x10], 'd'
	   mov  [ebp-0x0f], 'l'
	   mov  [ebp-0x0e], 'l'
	   mov  [ebp-0x0d], 0x0
	   lea  eax, [ebp-0x17]
	   push eax
	   call dword ptr[LoadLibraryA]
	   add esp,28
	   pop ebp
	   //hProc = GetProcAddress(hModUser32, “MessageBoxA”); 
	   push ebp
	   mov ebp,esp
	   sub esp,28
	   mov  [ebp-0x18], 'M'
	   mov  [ebp-0x17], 'e'
	   mov  [ebp-0x16], 's'
	   mov  [ebp-0x15], 's'
	   mov  [ebp-0x14], 'a'
	   mov  [ebp-0x13], 'g'
	   mov  [ebp-0x12], 'e'
	   mov  [ebp-0x11], 'B'
	   mov  [ebp-0x10], 'o'
	   mov  [ebp-0x0f], 'x'
	   mov  [ebp-0x0e], 'A'
	   mov  [ebp-0x0d], 0x0
	   lea  ecx, [ebp-0x18]
	   push ecx
	   push eax
	   call dword ptr[GetProcAddress]
	   add esp,28
	   pop ebp
	   //hProc(0,”I’m hacked!”, ”I’m hacked!”, MB_OK);
	   push ebp
	   mov ebp,esp
	   sub esp,28
	   mov  [ebp-0x18], 'I'
	   mov  [ebp-0x17], '\''
	   mov  [ebp-0x16], 'm'
	   mov  [ebp-0x15], ' '
	   mov  [ebp-0x14], 'h'
	   mov  [ebp-0x13], 'a'
	   mov  [ebp-0x12], 'c'
	   mov  [ebp-0x11], 'k'
	   mov  [ebp-0x10], 'e'
	   mov  [ebp-0x0f], 'd'
	   mov  [ebp-0x0e], '!'
	   mov  [ebp-0x0d], 0x0
	   lea  ecx, [ebp-0x18]
	   push 0
	   push ecx
	   push ecx
	   push 0	   
       call eax   
	   add esp,28
	   pop ebp
	   ret
	}
} 